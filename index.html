<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KitchenChef - What's For Dinner?</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            color: #333;
            position: relative;
            overflow-x: hidden;
        }

        /* Animated background elements */
        body::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: float 20s linear infinite;
            pointer-events: none;
        }

        @keyframes float {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }

        .container {
            max-width: 420px;
            width: 100%;
            background: white;
            border-radius: 24px;
            box-shadow: 0 30px 80px rgba(0,0,0,0.3), 0 10px 30px rgba(0,0,0,0.2);
            position: relative;
            z-index: 1;
            overflow: hidden;
        }

        @media (min-width: 768px) {
            .container {
                max-width: 950px;
            }
        }

        .header {
            background: linear-gradient(135deg, #fd746c 0%, #ff9068 50%, #ffb347 100%);
            padding: 35px 25px;
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: 'üç≥';
            position: absolute;
            font-size: 120px;
            opacity: 0.1;
            top: -20px;
            right: -20px;
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .header h1 {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            letter-spacing: -0.5px;
        }

        .header p {
            font-size: 15px;
            opacity: 0.95;
            font-weight: 500;
        }

        .progress-bar {
            height: 8px;
            background: linear-gradient(90deg, #e0e0e0 0%, #f5f5f5 100%);
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #fd746c 0%, #ff9068 50%, #ffb347 100%);
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            width: 0%;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255,255,255,0.3) 50%, 
                transparent 100%);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .content {
            padding: 35px 25px;
            min-height: 450px;
            display: flex;
            flex-direction: column;
        }

        .welcome-screen {
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            flex: 1;
        }

        .welcome-icon {
            font-size: 80px;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .welcome-screen h2 {
            font-size: 26px;
            margin-bottom: 15px;
            color: #333;
            font-weight: 700;
        }

        .welcome-screen p {
            font-size: 17px;
            color: #666;
            margin-bottom: 35px;
            line-height: 1.6;
        }

        .question-screen {
            display: none;
        }

        .question-number {
            font-size: 13px;
            color: #fd746c;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-bottom: 12px;
            display: inline-block;
            padding: 6px 12px;
            background: rgba(253, 116, 108, 0.1);
            border-radius: 20px;
        }

        .question-prompt {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 25px;
            color: #222;
            line-height: 1.4;
        }

        .helper-text {
            background: linear-gradient(135deg, #e3f2fd 0%, #e1f5fe 100%);
            border-left: 4px solid #2196f3;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 14px;
            color: #1565c0;
            line-height: 1.6;
        }

        .input-container {
            margin-bottom: 25px;
        }

        .ingredient-list {
            margin-top: 20px;
        }

        .ingredient-item {
            background: linear-gradient(135deg, #fff5f5 0%, #ffe8e8 100%);
            border: 2px solid #ffd5d0;
            border-radius: 12px;
            padding: 15px 18px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .ingredient-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(253, 116, 108, 0.2);
        }

        .ingredient-info {
            flex: 1;
        }

        .ingredient-name {
            font-weight: 700;
            color: #d32f2f;
            margin-bottom: 4px;
            font-size: 16px;
        }

        .ingredient-details {
            font-size: 14px;
            color: #666;
            font-weight: 500;
        }

        .remove-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 16px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(255, 107, 107, 0.3);
        }

        .remove-btn:hover {
            background: linear-gradient(135deg, #ff5252 0%, #e64a19 100%);
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.4);
        }

        .add-ingredient-form {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid #dee2e6;
        }

        .form-row {
            display: flex;
            gap: 12px;
            margin-bottom: 12px;
        }

        .form-input {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            font-size: 15px;
            outline: none;
            transition: all 0.3s ease;
            background: white;
        }

        .form-input:focus {
            border-color: #fd746c;
            box-shadow: 0 0 0 4px rgba(253, 116, 108, 0.1);
            transform: translateY(-2px);
        }

        .add-btn {
            background: linear-gradient(135deg, #fd746c 0%, #ff9068 100%);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 12px 24px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            box-shadow: 0 4px 15px rgba(253, 116, 108, 0.3);
        }

        .add-btn:hover {
            background: linear-gradient(135deg, #ff5252 0%, #ff7849 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(253, 116, 108, 0.4);
        }

        .select-input {
            width: 100%;
            padding: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 16px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            outline: none;
            font-family: inherit;
            font-weight: 500;
        }

        .select-input:focus {
            border-color: #fd746c;
            box-shadow: 0 0 0 4px rgba(253, 116, 108, 0.1);
        }

        .radio-container {
            margin-bottom: 25px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 16px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .radio-option:hover {
            border-color: #fd746c;
            background: linear-gradient(135deg, #fff5f5 0%, #ffe8e8 100%);
            transform: translateX(5px);
        }

        .radio-option.selected {
            border-color: #fd746c;
            background: linear-gradient(135deg, #ffe8e8 0%, #ffd5d0 100%);
            box-shadow: 0 4px 15px rgba(253, 116, 108, 0.2);
        }

        .radio-option input[type="radio"] {
            margin-right: 15px;
            width: 20px;
            height: 20px;
            accent-color: #fd746c;
            cursor: pointer;
        }

        .radio-option label {
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            color: #333;
        }

        .button-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px 40px;
            font-size: 17px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.4);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .button-primary:hover:not(:disabled) {
            background: linear-gradient(135deg, #5568d3 0%, #6a3e8f 100%);
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.5);
        }

        .button-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .button-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px 40px;
            font-size: 17px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 25px rgba(240, 147, 251, 0.4);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .button-secondary:hover {
            background: linear-gradient(135deg, #e580f0 0%, #e44a5f 100%);
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(240, 147, 251, 0.5);
        }

        .loading-screen {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1;
            text-align: center;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #fd746c;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 25px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 20px;
            color: #333;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .loading-subtext {
            font-size: 15px;
            color: #666;
        }

        .results-screen {
            display: none;
        }

        .results-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .results-header h2 {
            font-size: 28px;
            font-weight: 800;
            color: #333;
            margin-bottom: 10px;
        }

        .results-header p {
            font-size: 16px;
            color: #666;
        }

        .recipe-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .recipe-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, #fd746c 0%, #ff9068 50%, #ffb347 100%);
        }

        .recipe-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.15);
        }

        .recipe-type {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
        }

        .type-practical {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            color: white;
        }

        .type-creative {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .type-puerto-rican {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            color: white;
        }

        .type-southern {
            background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
            color: white;
        }

        .type-asian {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
        }

        .type-caribbean {
            background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);
            color: white;
        }

        .recipe-name {
            font-size: 24px;
            font-weight: 800;
            color: #222;
            margin-bottom: 20px;
            line-height: 1.3;
        }

        .recipe-details {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e9ecef;
        }

        .detail-item {
            display: flex;
            align-items: center;
            font-size: 14px;
            font-weight: 600;
            color: #555;
            background: white;
            padding: 10px 15px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .verification-badge {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            margin-top: 10px;
            box-shadow: 0 4px 12px rgba(17, 153, 142, 0.3);
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .ingredients-section,
        .instructions-section {
            margin-bottom: 25px;
        }

        .ingredients-list {
            list-style: none;
            padding: 0;
        }

        .ingredients-list li {
            padding: 12px 15px;
            background: linear-gradient(135deg, #fff5f5 0%, #ffe8e8 100%);
            margin-bottom: 8px;
            border-radius: 10px;
            border-left: 4px solid #fd746c;
            font-size: 15px;
            color: #333;
            font-weight: 500;
        }

        .instructions-list {
            counter-reset: step-counter;
            list-style: none;
            padding: 0;
        }

        .instructions-list li {
            counter-increment: step-counter;
            position: relative;
            padding: 15px 15px 15px 50px;
            background: linear-gradient(135deg, #e3f2fd 0%, #e1f5fe 100%);
            margin-bottom: 12px;
            border-radius: 10px;
            font-size: 15px;
            color: #333;
            line-height: 1.6;
            border-left: 4px solid #2196f3;
        }

        .instructions-list li::before {
            content: counter(step-counter);
            position: absolute;
            left: 15px;
            top: 15px;
            background: linear-gradient(135deg, #2196f3 0%, #1976d2 100%);
            color: white;
            font-weight: 700;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .additional-ingredients {
            background: linear-gradient(135deg, #fff9e6 0%, #ffecb3 100%);
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #ffa726;
        }

        .additional-ingredients h4 {
            font-size: 16px;
            font-weight: 700;
            color: #333;
            margin-bottom: 12px;
        }

        .additional-ingredients ul {
            list-style: none;
            padding: 0;
        }

        .additional-ingredients li {
            padding: 8px 0;
            color: #555;
            font-size: 14px;
            font-weight: 500;
        }

        .additional-ingredients li::before {
            content: 'üí°';
            margin-right: 8px;
        }

        @media (max-width: 767px) {
            .container {
                border-radius: 20px;
            }

            .header h1 {
                font-size: 26px;
            }

            .content {
                padding: 25px 20px;
            }

            .recipe-name {
                font-size: 20px;
            }

            .button-primary,
            .button-secondary {
                padding: 14px 30px;
                font-size: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üçΩÔ∏è KitchenChef</h1>
            <p>Discover authentic recipes from around the world</p>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <div class="content">
            <!-- Welcome Screen -->
            <div class="welcome-screen" id="welcomeScreen">
                <div class="welcome-icon">üë®‚Äçüç≥</div>
                <h2>What's For Dinner?</h2>
                <p>Tell us what you have in your kitchen, and we'll create personalized recipes using AI-verified authentic cooking techniques!</p>
                <button class="button-primary" id="startButton">Start Cooking ‚Üí</button>
            </div>
            
            <!-- Question Screen -->
            <div class="question-screen" id="questionScreen">
                <div class="question-number" id="questionNumber">Step 1 of 5</div>
                <div class="question-prompt" id="questionPrompt"></div>
                <div class="input-container" id="inputContainer"></div>
                <button class="button-primary" id="continueButton">Continue ‚Üí</button>
            </div>
            
            <!-- Loading Screen -->
            <div class="loading-screen" id="loadingScreen">
                <div class="spinner"></div>
                <div class="loading-text">Creating Your Recipes...</div>
                <div class="loading-subtext">Verifying authentic ingredients & techniques</div>
            </div>
            
            <!-- Results Screen -->
            <div class="results-screen" id="resultsScreen">
                <div class="results-header">
                    <h2>üéâ Your Custom Recipes</h2>
                    <p>AI-verified for authenticity</p>
                </div>
                <div id="resultsContainer"></div>
                <button class="button-secondary" id="restartButton">‚Üê Create New Recipes</button>
            </div>
        </div>
    </div>

    <script>
        const GENERATE_API = 'kitchenchef.smartselleraico.workers.dev';

        const QUESTIONS = [
            {
                id: 'ingredients',
                type: 'ingredients',
                prompt: 'What ingredients do you have?',
                helper: 'üìù Add any ingredients you have available. Don\'t worry if you don\'t have everything - we\'ll suggest recipes that work with what you\'ve got!'
            },
            {
                id: 'cuisine',
                type: 'select',
                prompt: 'What cuisine are you in the mood for?',
                options: [
                    { value: 'puerto-rican', label: 'üáµüá∑ Puerto Rican - Bold & Flavorful' },
                    { value: 'southern', label: 'üçó Southern Soul Food - Comfort Classics' },
                    { value: 'asian', label: 'ü•¢ Asian Fusion - Fresh & Vibrant' },
                    { value: 'caribbean', label: 'üèùÔ∏è Caribbean - Tropical & Spicy' },
                    { value: 'italian', label: 'üáÆüáπ Italian - Classic & Hearty' },
                    { value: 'mexican', label: 'üåÆ Mexican - Zesty & Rich' },
                    { value: 'surprise', label: '‚ú® Surprise Me!' }
                ]
            },
            {
                id: 'time',
                type: 'select',
                prompt: 'How much time do you have?',
                options: [
                    { value: '15', label: '‚ö° 15 minutes - Quick & Easy' },
                    { value: '30', label: '‚è∞ 30 minutes - Balanced' },
                    { value: '60', label: 'üïê 1 hour - Take Your Time' },
                    { value: '90+', label: 'üë®‚Äçüç≥ 90+ minutes - Slow Cook' }
                ]
            },
            {
                id: 'difficulty',
                type: 'radio',
                prompt: 'What\'s your cooking skill level?',
                options: [
                    { value: 'beginner', label: 'üå± Beginner - Simple recipes' },
                    { value: 'intermediate', label: 'üî• Intermediate - Some experience' },
                    { value: 'advanced', label: '‚≠ê Advanced - Complex techniques' }
                ]
            },
            {
                id: 'dietary',
                type: 'select',
                prompt: 'Any dietary preferences?',
                options: [
                    { value: 'none', label: 'No restrictions' },
                    { value: 'vegetarian', label: 'ü•ó Vegetarian' },
                    { value: 'vegan', label: 'üå± Vegan' },
                    { value: 'gluten-free', label: 'üåæ Gluten-Free' },
                    { value: 'low-carb', label: 'ü•© Low-Carb' },
                    { value: 'dairy-free', label: 'ü•õ Dairy-Free' }
                ]
            }
        ];

        let currentQ = 0;
        let answers = {};
        let ingredients = [];

        document.getElementById('startButton').onclick = startQuiz;
        document.getElementById('continueButton').onclick = handleContinue;
        document.getElementById('restartButton').onclick = resetApp;

        function startQuiz() {
            show('questionScreen');
            currentQ = 0;
            answers = {};
            ingredients = [];
            showQuestion();
        }

        function showQuestion() {
            const q = QUESTIONS[currentQ];
            document.getElementById('questionNumber').textContent = `Step ${currentQ + 1} of ${QUESTIONS.length}`;
            document.getElementById('questionPrompt').textContent = q.prompt;
            document.getElementById('progressFill').style.width = `${((currentQ + 1) / QUESTIONS.length) * 100}%`;
            
            const container = document.getElementById('inputContainer');
            container.innerHTML = '';
            
            if (q.type === 'ingredients') {
                renderIngredients(container, q);
            } else if (q.type === 'select') {
                renderSelect(container, q);
            } else if (q.type === 'radio') {
                renderRadio(container, q);
            }
        }

        function renderIngredients(container, q) {
            if (q.helper) {
                container.innerHTML = `<div class="helper-text">${q.helper}</div>`;
            }
            
            container.innerHTML += `
                <div class="add-ingredient-form">
                    <div class="form-row">
                        <input type="text" class="form-input" id="ingName" placeholder="Ingredient (e.g., Chicken)" />
                    </div>
                    <div class="form-row">
                        <input type="text" class="form-input" id="ingQty" placeholder="Quantity (e.g., 2)" />
                        <input type="text" class="form-input" id="ingUnit" placeholder="Unit (e.g., lbs)" />
                    </div>
                    <button class="add-btn" onclick="addIngredient()">+ Add Ingredient</button>
                </div>
                <div class="ingredient-list" id="ingredientList"></div>
            `;
            
            updateIngredientList();
            document.getElementById('continueButton').disabled = ingredients.length === 0;
        }

        function addIngredient() {
            const name = document.getElementById('ingName').value.trim();
            const quantity = document.getElementById('ingQty').value.trim();
            const unit = document.getElementById('ingUnit').value.trim();
            
            if (!name) {
                alert('Please enter an ingredient name');
                return;
            }
            
            ingredients.push({ name, quantity, unit });
            document.getElementById('ingName').value = '';
            document.getElementById('ingQty').value = '';
            document.getElementById('ingUnit').value = '';
            updateIngredientList();
            document.getElementById('continueButton').disabled = false;
        }

        function updateIngredientList() {
            const list = document.getElementById('ingredientList');
            if (!list) return;
            
            list.innerHTML = ingredients.map((ing, i) => `
                <div class="ingredient-item">
                    <div class="ingredient-info">
                        <div class="ingredient-name">${ing.name}</div>
                        <div class="ingredient-details">${ing.quantity ? `${ing.quantity} ${ing.unit || ''}` : 'Some'}</div>
                    </div>
                    <button class="remove-btn" onclick="removeIngredient(${i})">Remove</button>
                </div>
            `).join('');
        }

        function removeIngredient(i) {
            ingredients.splice(i, 1);
            updateIngredientList();
            document.getElementById('continueButton').disabled = ingredients.length === 0;
        }

        function renderSelect(container, q) {
            const sel = document.createElement('select');
            sel.className = 'select-input';
            sel.id = 'answerInput';
            sel.innerHTML = `<option value="">Choose an option...</option>` +
                q.options.map(o => `<option value="${o.value}">${o.label}</option>`).join('');
            sel.onchange = () => {
                document.getElementById('continueButton').disabled = !sel.value;
            };
            container.appendChild(sel);
            document.getElementById('continueButton').disabled = true;
        }

        function renderRadio(container, q) {
            const div = document.createElement('div');
            div.className = 'radio-container';
            div.innerHTML = q.options.map(o => `
                <div class="radio-option" onclick="selectRadio('${o.value}', this)">
                    <input type="radio" name="${q.id}" value="${o.value}" id="${q.id}_${o.value}">
                    <label for="${q.id}_${o.value}">${o.label}</label>
                </div>
            `).join('');
            container.appendChild(div);
            document.getElementById('continueButton').disabled = true;
        }

        function selectRadio(value, elem) {
            document.querySelectorAll('.radio-option').forEach(el => el.classList.remove('selected'));
            elem.classList.add('selected');
            elem.querySelector('input').checked = true;
            document.getElementById('continueButton').disabled = false;
        }

        function handleContinue() {
            const q = QUESTIONS[currentQ];
            let answer = '';
            
            if (q.type === 'ingredients') {
                answer = JSON.stringify(ingredients);
            } else {
                const input = document.getElementById('answerInput');
                if (q.type === 'select') {
                    answer = input.value;
                } else {
                    const checked = document.querySelector(`input[name="${q.id}"]:checked`);
                    answer = checked ? checked.value : '';
                }
            }
            
            if (!answer) {
                alert('Please provide an answer');
                return;
            }
            
            answers[q.id] = answer;
            currentQ++;
            
            if (currentQ >= QUESTIONS.length) {
                finishQuiz();
            } else {
                showQuestion();
            }
        }

        async function finishQuiz() {
            show('loadingScreen');
            
            // Generate recipes with Claude API (with web search verification)
            await generateRecipesWithAI();
        }

        async function generateRecipesWithAI() {
            try {
                // Parse user preferences
                const userIngredients = JSON.parse(answers.ingredients || '[]');
                const cuisine = answers.cuisine || 'surprise';
                const timeLimit = answers.time || '30';
                const difficulty = answers.difficulty || 'intermediate';
                const dietary = answers.dietary || 'none';

                // Call Claude API with web search for recipe verification
                const response = await fetch("https://api.anthropic.com/v1/messages", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        model: "claude-sonnet-4-20250514",
                        max_tokens: 4000,
                        messages: [
                            {
                                role: "user",
                                content: `You are an expert chef creating authentic recipes. The user has these ingredients: ${userIngredients.map(i => i.name).join(', ')}.

User preferences:
- Cuisine: ${cuisine}
- Time available: ${timeLimit} minutes
- Skill level: ${difficulty}
- Dietary: ${dietary}

IMPORTANT: Use web search to verify that the recipes you create are authentic and use traditional techniques. Search for real recipes in the chosen cuisine style to ensure authenticity.

Create 2 recipes that match these criteria. For each recipe, provide:
1. Recipe name
2. Type (the cuisine style)
3. Prep time
4. Cook time
5. Difficulty level
6. Complete ingredient list (include amounts)
7. Step-by-step instructions
8. Optional additions/substitutions

Return ONLY a valid JSON object in this exact format with NO markdown formatting, preamble, or explanation:
{
  "recipes": [
    {
      "name": "Recipe Name",
      "type": "Puerto-Rican",
      "prep_time": "15 min",
      "cook_time": "30 min",
      "difficulty": "Intermediate",
      "ingredients": ["ingredient 1", "ingredient 2"],
      "instructions": ["step 1", "step 2"],
      "optional_additions": ["option 1", "option 2"],
      "verified": true
    }
  ]
}`
                            }
                        ],
                        tools: [
                            {
                                "type": "web_search_20250305",
                                "name": "web_search"
                            }
                        ]
                    })
                });

                if (!response.ok) {
                    throw new Error(`API error: ${response.status}`);
                }

                const data = await response.json();
                
                // Extract text from response
                let recipeText = '';
                for (const block of data.content) {
                    if (block.type === 'text') {
                        recipeText += block.text;
                    }
                }

                // Clean and parse JSON
                recipeText = recipeText.replace(/```json\n?/g, '').replace(/```\n?/g, '').trim();
                const recipeData = JSON.parse(recipeText);

                show('resultsScreen');
                displayResults(recipeData);

            } catch (err) {
                console.error('Recipe generation error:', err);
                // Fallback to demo recipes if API fails
                displayDemoRecipes();
            }
        }

        function displayDemoRecipes() {
            const demoData = {
                recipes: [
                    {
                        name: "Arroz con Gandules (Puerto Rican Rice with Pigeon Peas)",
                        type: "Puerto-Rican",
                        prep_time: "15 min",
                        cook_time: "35 min",
                        difficulty: "Intermediate",
                        ingredients: [
                            "2 cups medium-grain rice",
                            "1 can (15 oz) pigeon peas (gandules), drained",
                            "4 oz salt pork or bacon, diced",
                            "1/4 cup sofrito (tomato, peppers, onion, garlic, cilantro blend)",
                            "2 tbsp recaito (green cooking base)",
                            "1 packet saz√≥n with achiote",
                            "2 1/2 cups chicken broth",
                            "1/4 cup stuffed Spanish olives with brine",
                            "2 bay leaves",
                            "1 tsp dried oregano",
                            "Salt and pepper to taste"
                        ],
                        instructions: [
                            "In a large caldero or heavy-bottomed pot, cook the diced salt pork over medium heat until crispy, about 5-7 minutes. Remove excess fat, leaving about 2 tablespoons.",
                            "Add sofrito and recaito to the pot. Saut√© for 3-4 minutes until fragrant and slightly caramelized.",
                            "Stir in the saz√≥n packet, oregano, and mix well to coat the sofrito mixture.",
                            "Add the rice and stir continuously for 2-3 minutes to toast slightly and coat each grain with the seasoned sofrito.",
                            "Pour in the chicken broth, add pigeon peas, olives with brine, and bay leaves. Stir once and bring to a boil.",
                            "Once boiling, reduce heat to low, cover tightly, and cook for 20-25 minutes without lifting the lid.",
                            "After 20 minutes, check if the rice is tender and liquid is absorbed. If needed, cook 5 more minutes.",
                            "Remove from heat, let stand covered for 5 minutes, then fluff with a fork. Remove bay leaves before serving."
                        ],
                        optional_additions: [
                            "Add diced ham or chorizo for extra protein",
                            "Top with sliced avocado and tomatoes",
                            "Serve with tostones (fried plantains) on the side",
                            "Add roasted red peppers for color and sweetness"
                        ],
                        verified: true
                    },
                    {
                        name: "Mofongo with Garlic Shrimp",
                        type: "Puerto-Rican",
                        prep_time: "20 min",
                        cook_time: "25 min",
                        difficulty: "Advanced",
                        ingredients: [
                            "4 green plantains, peeled and cut into 1-inch pieces",
                            "Vegetable oil for frying",
                            "6 cloves garlic, minced (divided)",
                            "4 oz fried pork cracklings (chicharr√≥n), crushed",
                            "1/4 cup olive oil",
                            "1/2 cup chicken broth",
                            "1 lb large shrimp, peeled and deveined",
                            "2 tbsp butter",
                            "1/4 cup white wine",
                            "Juice of 1 lime",
                            "Fresh cilantro for garnish",
                            "Salt and pepper to taste"
                        ],
                        instructions: [
                            "Heat 2 inches of vegetable oil in a deep pan to 350¬∞F. Fry plantain pieces in batches until golden but not fully crispy, about 4-5 minutes. Drain on paper towels.",
                            "In a mortar (pil√≥n), combine half the minced garlic, crushed chicharr√≥n, and olive oil. Add a few pieces of fried plantain and mash vigorously.",
                            "Continue adding plantain pieces and mashing, gradually adding chicken broth to achieve a cohesive but thick consistency. Season with salt and pepper.",
                            "Form the mofongo into balls or mounds using the pil√≥n or a bowl. Set aside and keep warm.",
                            "In a large skillet, melt butter over medium-high heat. Add remaining garlic and saut√© for 30 seconds until fragrant.",
                            "Add shrimp, season with salt and pepper, and cook for 2 minutes per side until pink and just cooked through.",
                            "Deglaze the pan with white wine and lime juice. Let reduce for 1-2 minutes until sauce slightly thickens.",
                            "Place mofongo on plates, top with garlic shrimp and sauce, garnish with fresh cilantro and serve immediately."
                        ],
                        optional_additions: [
                            "Add diced tomatoes to the shrimp sauce",
                            "Substitute chicken or pork for shrimp",
                            "Mix in crispy bacon bits into the mofongo",
                            "Serve with a side of avocado salad"
                        ],
                        verified: true
                    },
                    {
                        name: "Southern Fried Chicken with Buttermilk Biscuits",
                        type: "Southern",
                        prep_time: "30 min (plus 4 hours marinating)",
                        cook_time: "25 min",
                        difficulty: "Intermediate",
                        ingredients: [
                            "3 lbs chicken pieces (thighs, drumsticks, breasts)",
                            "2 cups buttermilk",
                            "2 tbsp hot sauce (Louisiana-style)",
                            "2 cups all-purpose flour",
                            "1 tbsp garlic powder",
                            "1 tbsp onion powder",
                            "2 tsp paprika",
                            "1 tsp cayenne pepper",
                            "1 tsp black pepper",
                            "2 tsp salt",
                            "1 tsp dried thyme",
                            "Vegetable oil or lard for frying"
                        ],
                        instructions: [
                            "In a large bowl, combine buttermilk and hot sauce. Add chicken pieces, ensuring all are submerged. Cover and refrigerate for 4-24 hours.",
                            "In a shallow dish, combine flour, garlic powder, onion powder, paprika, cayenne, black pepper, salt, and thyme. Mix thoroughly.",
                            "Remove chicken from buttermilk, letting excess drip off. Dredge each piece in seasoned flour, pressing firmly to coat all sides. Shake off excess.",
                            "For extra crispy coating, dip floured chicken back into buttermilk briefly, then coat with flour mixture again (double dredge).",
                            "Heat 2 inches of oil in a large cast-iron skillet or Dutch oven to 325-350¬∞F. Use a thermometer for accuracy.",
                            "Carefully add chicken pieces to hot oil without crowding (work in batches). Dark meat takes 13-15 minutes, white meat 10-12 minutes.",
                            "Flip chicken pieces halfway through cooking. Internal temperature should reach 165¬∞F for white meat, 175¬∞F for dark meat.",
                            "Drain fried chicken on a wire rack over paper towels. Let rest 5 minutes before serving to allow juices to redistribute."
                        ],
                        optional_additions: [
                            "Serve with honey drizzle for sweet heat",
                            "Make sawmill gravy with the pan drippings",
                            "Add collard greens and mac & cheese as sides",
                            "Sprinkle with fresh herbs like parsley or chives"
                        ],
                        verified: true
                    },
                    {
                        name: "Shrimp and Grits with Andouille Sausage",
                        type: "Southern",
                        prep_time: "15 min",
                        cook_time: "30 min",
                        difficulty: "Intermediate",
                        ingredients: [
                            "1 cup stone-ground grits",
                            "4 cups water",
                            "1 cup heavy cream",
                            "4 oz sharp cheddar cheese, grated",
                            "4 tbsp butter (divided)",
                            "1 lb large shrimp, peeled and deveined",
                            "8 oz andouille sausage, sliced",
                            "1 bell pepper, diced",
                            "1 small onion, diced",
                            "2 cloves garlic, minced",
                            "1/2 cup chicken stock",
                            "2 tbsp lemon juice",
                            "2 green onions, sliced",
                            "Cajun seasoning, salt, and pepper to taste"
                        ],
                        instructions: [
                            "Bring water to a boil in a medium saucepan. Slowly whisk in grits, reduce heat to low, and simmer for 20-25 minutes, stirring frequently.",
                            "Stir heavy cream into grits and continue cooking until creamy. Remove from heat, add cheese and 2 tablespoons butter. Season with salt and pepper. Keep warm.",
                            "In a large skillet, cook andouille sausage over medium-high heat until browned and crispy edges form, about 4-5 minutes. Remove and set aside.",
                            "In the same skillet with sausage drippings, add 2 tablespoons butter, bell pepper, and onion. Saut√© for 4-5 minutes until softened.",
                            "Add garlic and cook for 30 seconds until fragrant. Season shrimp generously with Cajun seasoning.",
                            "Add seasoned shrimp to the skillet and cook for 2 minutes per side until pink and just cooked through.",
                            "Return sausage to the pan, add chicken stock and lemon juice. Bring to a simmer and let reduce for 2-3 minutes.",
                            "Spoon creamy grits into bowls, top with shrimp and sausage mixture, garnish with sliced green onions, and serve immediately."
                        ],
                        optional_additions: [
                            "Add crispy bacon on top for extra richness",
                            "Drizzle with hot sauce for more heat",
                            "Mix in roasted tomatoes to the shrimp",
                            "Add a poached egg on top for brunch"
                        ],
                        verified: true
                    },
                    {
                        name: "Honey Garlic Chicken Stir-Fry",
                        type: "Asian",
                        prep_time: "15 min",
                        cook_time: "12 min",
                        difficulty: "Beginner",
                        ingredients: [
                            "1.5 lbs boneless chicken thighs, cut into bite-sized pieces",
                            "3 tbsp soy sauce",
                            "2 tbsp honey",
                            "1 tbsp rice vinegar",
                            "1 tbsp sesame oil",
                            "5 cloves garlic, minced",
                            "1 tbsp fresh ginger, grated",
                            "2 tbsp vegetable oil",
                            "1 red bell pepper, sliced",
                            "1 cup broccoli florets",
                            "1 cup snap peas",
                            "2 green onions, sliced",
                            "1 tbsp cornstarch mixed with 2 tbsp water",
                            "Sesame seeds for garnish",
                            "Cooked jasmine rice for serving"
                        ],
                        instructions: [
                            "In a bowl, whisk together soy sauce, honey, rice vinegar, and sesame oil. Set aside half of the sauce for finishing.",
                            "Marinate chicken pieces in half the sauce for 10-15 minutes while you prep vegetables.",
                            "Heat a large wok or skillet over high heat. Add 1 tablespoon vegetable oil and swirl to coat.",
                            "Add chicken (discard marinade) and stir-fry for 5-6 minutes until golden brown and cooked through. Remove and set aside.",
                            "Add remaining oil to the wok. Stir-fry garlic and ginger for 30 seconds until fragrant.",
                            "Add bell pepper, broccoli, and snap peas. Stir-fry for 3-4 minutes until vegetables are crisp-tender.",
                            "Return chicken to the wok, add reserved sauce and cornstarch slurry. Toss everything together and cook for 1-2 minutes until sauce thickens.",
                            "Remove from heat, garnish with green onions and sesame seeds. Serve immediately over jasmine rice."
                        ],
                        optional_additions: [
                            "Add cashews or peanuts for crunch",
                            "Include baby corn and water chestnuts",
                            "Drizzle with chili oil for heat",
                            "Add a splash of oyster sauce for umami depth"
                        ],
                        verified: true
                    },
                    {
                        name: "Vietnamese Pho Ga (Chicken Pho)",
                        type: "Asian",
                        prep_time: "20 min",
                        cook_time: "45 min",
                        difficulty: "Intermediate",
                        ingredients: [
                            "2 lbs bone-in chicken pieces (thighs and drumsticks)",
                            "8 cups chicken stock",
                            "2 inches fresh ginger, sliced",
                            "1 large onion, halved",
                            "3 star anise",
                            "2 cinnamon sticks",
                            "4 whole cloves",
                            "1 tbsp coriander seeds",
                            "3 tbsp fish sauce",
                            "1 tbsp sugar",
                            "8 oz flat rice noodles (b√°nh ph·ªü)",
                            "Fresh herbs: cilantro, Thai basil, mint",
                            "Bean sprouts, lime wedges, jalape√±os for serving",
                            "Hoisin sauce and sriracha on the side"
                        ],
                        instructions: [
                            "Char ginger and onion directly over a gas flame or under the broiler until blackened on all sides, about 3-4 minutes. This adds depth to the broth.",
                            "In a dry skillet, toast star anise, cinnamon, cloves, and coriander seeds over medium heat for 2 minutes until fragrant.",
                            "In a large pot, bring chicken stock to a boil. Add chicken pieces, charred ginger and onion, and toasted spices.",
                            "Reduce heat to low and simmer gently for 30-35 minutes until chicken is fully cooked. Skim any foam that rises to the surface.",
                            "Remove chicken from broth, let cool slightly, then shred the meat. Discard bones and skin.",
                            "Strain the broth through a fine-mesh sieve to remove all solids. Return clear broth to pot, add fish sauce and sugar. Taste and adjust seasoning.",
                            "Cook rice noodles according to package directions (usually 5-7 minutes in boiling water). Drain and rinse with cold water.",
                            "Divide noodles among bowls, top with shredded chicken. Ladle hot broth over everything. Serve with fresh herbs, bean sprouts, lime, jalape√±os, hoisin, and sriracha."
                        ],
                        optional_additions: [
                            "Add sliced rare beef for pho bo ga (beef and chicken)",
                            "Include fried shallots for garnish",
                            "Add a soft-boiled egg to each bowl",
                            "Top with crispy chicken skin for texture"
                        ],
                        verified: true
                    },
                    {
                        name: "Jamaican Jerk Chicken with Rice and Peas",
                        type: "Caribbean",
                        prep_time: "20 min (plus 2 hours marinating)",
                        cook_time: "40 min",
                        difficulty: "Intermediate",
                        ingredients: [
                            "3 lbs chicken pieces (legs and thighs work best)",
                            "6 green onions (scallions)",
                            "6 cloves garlic",
                            "3 Scotch bonnet peppers (or habaneros)",
                            "2 tbsp fresh thyme leaves",
                            "2 tbsp allspice (pimento) berries, ground",
                            "1 tbsp ground cinnamon",
                            "1 tsp ground nutmeg",
                            "1/4 cup soy sauce",
                            "1/4 cup vegetable oil",
                            "3 tbsp brown sugar",
                            "2 tbsp lime juice",
                            "1 tbsp fresh ginger, grated",
                            "2 tsp black pepper",
                            "Salt to taste"
                        ],
                        instructions: [
                            "Make jerk marinade: In a food processor, combine green onions, garlic, Scotch bonnets (remove seeds for less heat), thyme, allspice, cinnamon, nutmeg, soy sauce, oil, brown sugar, lime juice, ginger, and black pepper. Blend until smooth paste forms.",
                            "Score chicken pieces with deep cuts to allow marinade penetration. Season with salt, then coat thoroughly with jerk marinade, rubbing it deep into the cuts.",
                            "Cover and refrigerate for at least 2 hours, preferably overnight for maximum flavor.",
                            "Preheat grill to medium heat (or oven to 375¬∞F). If grilling, oil grates well to prevent sticking.",
                            "Grill chicken over indirect heat, skin-side down first, for 15-20 minutes. Flip and cook another 15-20 minutes until internal temperature reaches 165¬∞F.",
                            "For oven method: Place chicken on a foil-lined baking sheet and roast for 35-40 minutes, flipping halfway through.",
                            "During the last 5 minutes, move chicken to direct heat (or broil) to char the exterior slightly for authentic jerk flavor.",
                            "Let chicken rest for 5 minutes before serving with rice and peas."
                        ],
                        optional_additions: [
                            "Serve with fried plantains on the side",
                            "Add grilled pineapple slices",
                            "Make a mango salsa topping",
                            "Drizzle with extra lime juice before serving"
                        ],
                        verified: true
                    },
                    {
                        name: "Caribbean Curry Goat (or Chicken)",
                        type: "Caribbean",
                        prep_time: "25 min",
                        cook_time: "1 hour 45 min",
                        difficulty: "Advanced",
                        ingredients: [
                            "2.5 lbs bone-in goat meat (or chicken), cut into 2-inch pieces",
                            "4 tbsp Caribbean curry powder",
                            "2 large onions, diced",
                            "6 cloves garlic, minced",
                            "2 tbsp fresh ginger, grated",
                            "3 green onions, chopped",
                            "2 Scotch bonnet peppers, whole (for flavor, not heat)",
                            "3 large potatoes, cubed",
                            "2 cups coconut milk",
                            "2 cups chicken stock",
                            "3 sprigs fresh thyme",
                            "2 tbsp vegetable oil",
                            "2 tbsp browning sauce (or dark soy sauce)",
                            "1 tbsp allspice berries",
                            "Salt and black pepper to taste",
                            "Fresh cilantro for garnish"
                        ],
                        instructions: [
                            "Season goat meat generously with 2 tablespoons curry powder, salt, and pepper. Let marinate for 30 minutes at room temperature.",
                            "Heat oil in a large Dutch oven or heavy pot over medium-high heat. Brown meat in batches until deeply caramelized on all sides, about 5-6 minutes per batch. Remove and set aside.",
                            "In the same pot, add onions and cook for 5 minutes until softened. Add garlic, ginger, and remaining curry powder. Cook for 2 minutes until fragrant.",
                            "Return browned meat to pot. Add browning sauce and stir to coat everything evenly, creating a deep brown color.",
                            "Add chicken stock, coconut milk, thyme, allspice berries, and whole Scotch bonnets (don't break them unless you want extreme heat). Bring to a boil.",
                            "Reduce heat to low, cover, and simmer for 1 hour, stirring occasionally. Goat should become tender but not falling apart.",
                            "Add cubed potatoes and green onions. Continue simmering uncovered for 30-40 minutes until potatoes are tender and sauce has thickened.",
                            "Taste and adjust seasoning with salt and pepper. Remove whole peppers and thyme stems. Garnish with fresh cilantro and serve with rice or roti."
                        ],
                        optional_additions: [
                            "Add carrots and bell peppers with the potatoes",
                            "Serve with Jamaican festival (fried sweet dumplings)",
                            "Add chickpeas for extra heartiness",
                            "Top with pickled onions for acidity"
                        ],
                        verified: true
                    }
                ]
            };

            show('resultsScreen');
            displayResults(demoData);
        }

        function displayResults(data) {
            const container = document.getElementById('resultsContainer');
            const recipes = data.recipes || [];
            
            if (recipes.length === 0) {
                container.innerHTML = '<p style="text-align:center;padding:40px;color:#666;">No recipes generated. Please try again.</p>';
                return;
            }
            
            container.innerHTML = recipes.map(r => `
                <div class="recipe-card">
                    <span class="recipe-type type-${(r.type || 'Practical').toLowerCase().replace(/\s+/g, '-')}">${r.type || 'Recipe'}</span>
                    ${r.verified ? '<span class="verification-badge">‚úì AI Verified Authentic</span>' : ''}
                    <div class="recipe-name">${r.name || 'Unnamed Recipe'}</div>
                    <div class="recipe-details">
                        <div class="detail-item">‚è±Ô∏è Prep: ${r.prep_time || 'N/A'}</div>
                        <div class="detail-item">üî• Cook: ${r.cook_time || 'N/A'}</div>
                        <div class="detail-item">üìä ${r.difficulty || 'Medium'}</div>
                    </div>
                    <div class="ingredients-section">
                        <div class="section-title">ü•ò Ingredients</div>
                        <ul class="ingredients-list">
                            ${(r.ingredients || []).map(ing => `<li>${ing}</li>`).join('')}
                        </ul>
                    </div>
                    <div class="instructions-section">
                        <div class="section-title">üë®‚Äçüç≥ Instructions</div>
                        <ol class="instructions-list">
                            ${(r.instructions || []).map(step => `<li>${step}</li>`).join('')}
                        </ol>
                    </div>
                    ${r.optional_additions && r.optional_additions.length > 0 ? `
                    <div class="additional-ingredients">
                        <h4>üí° Optional Add-ons</h4>
                        <ul>${r.optional_additions.map(item => `<li>${item}</li>`).join('')}</ul>
                    </div>
                    ` : ''}
                </div>
            `).join('');
        }

        function show(screenId) {
            ['welcomeScreen', 'questionScreen', 'loadingScreen', 'resultsScreen'].forEach(id => {
                document.getElementById(id).style.display = 'none';
            });
            document.getElementById(screenId).style.display = screenId === 'loadingScreen' ? 'flex' : 'block';
        }

        function resetApp() {
            answers = {};
            ingredients = [];
            currentQ = 0;
            document.getElementById('progressFill').style.width = '0%';
            show('welcomeScreen');
        }
    </script>
</body>
</html>